{% extends 'portal/base.html' %}

{% block title %}Arhivă | Administrare{% endblock %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h1 class="h5 mb-0">Arhivă</h1>
    <div class="text-muted small">Elementele arhivate nu apar în listele principale și pot fi restabilite de aici.</div>
  </div>
  <div class="d-flex gap-2">
    <a class="btn btn-outline-secondary btn-sm" href="{% url 'admin_chestionare_list' %}"><i class="bi bi-ui-checks-grid me-1"></i>Chestionare</a>
    <a class="btn btn-outline-secondary btn-sm" href="{% url 'admin_experti_list' %}"><i class="bi bi-people me-1"></i>Experți</a>
  </div>
</div>

<div class="row g-3">
  <div class="col-lg-6">
    <div class="card shadow-sm gov-card">
      <div class="card-header bg-white"><strong><i class="bi bi-ui-checks-grid me-1"></i>Chestionare arhivate</strong></div>
      <div class="card-body">
        {% if chestionare %}
          <div class="table-responsive">
            <table class="table align-middle">
              <thead>
                <tr>
                  <th>Titlu</th>
                  <th class="text-nowrap">Arhivat la</th>
                  <th class="text-end"></th>
                </tr>
              </thead>
              <tbody>
                {% for c in chestionare %}
                  <tr>
                    <td>
                      <div class="fw-semibold">{{ c.titlu }}</div>
                      {% if c.descriere %}<div class="text-muted small">{{ c.descriere|truncatechars:80 }}</div>{% endif %}
                      <div class="small text-muted">Termen: {{ c.termen_limita|date:"d.m.Y H:i" }}</div>
                    </td>
                    <td class="text-nowrap">{{ c.arhivat_la|date:"d.m.Y" }}</td>
                    <td class="text-end">
                      <a class="btn btn-sm btn-outline-primary" href="{% url 'admin_chestionar_raspunsuri' c.pk %}"><i class="bi bi-table me-1"></i>Răspunsuri</a>
                      <a class="btn btn-sm btn-success" href="{% url 'admin_chestionar_restabilire' c.pk %}">Restabilește</a>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <div class="text-muted">Nu există chestionare arhivate.</div>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="col-lg-6">
    <div class="card shadow-sm gov-card">
      <div class="card-header bg-white"><strong><i class="bi bi-people me-1"></i>Experți arhivați</strong></div>
      <div class="card-body">
        {% if experti %}
          <div class="table-responsive">
            <table class="table align-middle">
              <thead>
                <tr>
                  <th>Nume</th>
                  <th>Email</th>
                  <th class="text-nowrap">Arhivat la</th>
                  <th class="text-end"></th>
                </tr>
              </thead>
              <tbody>
                {% for e in experti %}
                  <tr>
                    <td class="fw-semibold">{{ e.get_full_name|default:e.username }}</td>
                    <td>{{ e.email }}</td>
                    <td class="text-nowrap">{{ e.profil_expert.arhivat_la|date:"d.m.Y" }}</td>
                    <td class="text-end">
                      <a class="btn btn-sm btn-success" href="{% url 'admin_expert_restabilire' e.pk %}">Restabilește</a>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <div class="text-muted">Nu există experți arhivați.</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
